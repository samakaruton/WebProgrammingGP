<!DOCTYPE html> 
<html lang="en"> 
    <head> 
        <meta charset="UTF-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <title>Player Registration</title> 
    </head>
    <style>
        tr, th, td{
            padding: 14px;
        }
    </style> 
    <body> 
        <center>
            <h1>Player Registration</h1> 
            <form id="registerForm"> 
                <label for="firstName">First Name:</label><br> 
                <input type="text" id="firstName" name="firstName" required minlength="4"><br> 
                <label for="lastName">Last Name:</label><br> 
                <input type="text" id="lastName" name="lastName" required minlength="4"><br> 
                <label for="dob">Date of Birth:</label><br> 
                <input type="date" id="dob" name="dob" required ><br> 
                <label for="age">Age:</label><br> 
                <input type="number" id="age" name="age" disabled><br> 
                <label for="gender">Gender:</label><br> 
                <select id="gender" name="gender" required> 
                    <option value="">Select...</option> 
                    <option value="male">Male</option> 
                    <option value="female">Female</option> 
                    <option value="other">Other</option> 
                </select><br> 
                <label for="email">Email:</label><br> 
                <input type="email" id="email" name="email" required pattern=".+@gmail.com$"><br> 
                <button type="button" id="registerButton" onclick="Register()">Register</button> 
            </form> <br><br>
            <button type="button" id="startButton" disabled onclick="PlayGame()">Start</button> 
            <button type="button" id="endButton" disabled>End</button>

            <br><br>
   
            <div id="gamearea" style="display:none; width: 60%; height: 1200px; border: 2px solid #000;" disabled>
                <p>Calculate:</p>
                <span id="num1"></span> x <span id="num2"></span> = <input type="number" id="answerInput" min="0" required>
                <!--Task 7-->
                <button id="acceptButton" onclick="CheckAnswer()">CheckAnswer</button>
                <p id="result"></p>
                <!--Task 8-->
                <button id="nextButton" onclick="PlayGame()">Next</button>
                <!--Task 9-->
                <div id="stats" style="margin-top: 20px;">
                    <table id="showpercentage" style="border: 1px solid;">
                        <caption>Scoreboard</caption>
                        <tr>
                            <th>Rank</th>
                            <th>Name</th>
                            <th>Current Score</th>
                            <th>Correct Answers</th>
                            <th>Incorrect Answers</th>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
                </div>
            </div>

            

            <br><br>
            <button type="button" id="accept" disabled style="display:none;">Accept</button><br>
            <button type="button" id="next" disabled style="display:none;">Next</button>
            
        </center>
        
    </body>
    <script>
        // A global storage entity for the registered players.
        let PlayerRegistrationData = [];

        //Getting the elements needed to calculate the age of the user
        let today = new Date();
        let dd = String(today.getDate()).padStart(2, '0');
        let mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
        let yyyy = today.getFullYear();

        today = yyyy + '-' + mm + '-' + dd;

        document.getElementById('dob').setAttribute('max', today);

        //Function that will calculate the age of the user and add it to the dedicated field
        function CalculateAge(){
            let dob = new Date(document.getElementById('dob').value);
            let today = new Date();
            let age = today.getFullYear() - dob.getFullYear();
            let monthDiff = today.getMonth() - dob.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
                age--;
            }

            document.getElementById('age').value = age;
        }

        document.getElementById('dob').addEventListener('change',CalculateAge);

        function enableButtons(){
            document.getElementById('startButton').disabled = false;
            document.getElementById('endButton').disabled = false;
        }

        //Register function
        function Register() {
            // Fetch the entered values from the form.
            let firstName = document.getElementById('firstName').value;
            let lastName = document.getElementById('lastName').value;
            let dob = document.getElementById('dob').value;
            //let age = document.getElementById('age').value;
            let gender = document.getElementById('gender').value;
            let email = document.getElementById('email').value;

            // Perform basic validation checks on the entered values.
            if (!firstName || !lastName || !dob || !gender || !email) {
                alert('All fields are required. Please fill all the details.');
                return;
            }

            if (age < 8 || age > 12) {
                alert('Age must be between 8 and 12 inclusive.');
                return;
            }

            if (firstName.length < 3 || lastName.length < 3) {
                alert('First and Last Name must be more than three (3) characters in length.');
                return;
            }

            if (!email.endsWith('@gmail.com' || !email.endsWith('@GMAIL.COM'))) {
                alert('Email address must be validated to only accept email addresses that ends with “@gmail.com”.');
                return;
            }

            // Create an object to store the validated registration details.
            let playerDetails = {
                firstName: firstName,
                lastName: lastName,
                dob: dob,
                age: age,
                gender: gender,
                email: email
            };

            // Append the validated player details to the global storage entity.
            PlayerRegistrationData.push(playerDetails);
            localStorage.setItem("PlayerRegistrationData",JSON.stringify(PlayerRegistrationData));

            // Display a confirmation message to the user.
            alert('Player registered successfully!');
            enableButtons();

            let fname = document.getElementById('firstName');
            let lname = document.getElementById('lastName');
            let birth = document.getElementById('dob');
            let g = document.getElementById('gender');
            let em = document.getElementById('email');

            if(fname.value && lname.value && birth.value && g.value && em.value){
                fname.disabled = true;
                lname.disabled = true;
                birth.disabled = true;
                g.disabled = true;
                em.disabled = true;
            }

            document.getElementById('registerButton').disabled = true;
            displayAllPlayers();

        }

        //document.getElementById('registerButton').addEventListener('click',enableButtons);

        // Task 4
        function PlayGame() {
            document.getElementById('gamearea').style.display="block";
            document.getElementById('accept').style.display="block";
            document.getElementById('next').style.display ="block";

            let num1 = Math.floor(Math.random() * 9) + 1;
            let num2 = Math.floor(Math.random() * 5) + 1;


            document.getElementById("num1").textContent = num1; 
            document.getElementById("num2").textContent = num2;
        }

       

        // Task 5  
        let startButton = document.getElementById("startButton");
        startButton.addEventListener("click", function() {
        PlayGame();
        
        document.getElementById("playArea").disabled = false;
        document.getElementById("answerInput").disabled = false;
        document.getElementById("acceptButton").disabled = false; 
        document.getElementById("nextButton").disabled = false;
        });

        // Task 6
        function CheckAnswer() {
            let num1 = parseInt(document.getElementById("num1").textContent);
            let num2 = parseInt(document.getElementById("num2").textContent);
            let actualAnswer = num1 * num2;

            let userAnswer = parseInt(document.getElementById("answerInput").value);

            let result = document.getElementById("result");
            if(userAnswer === actualAnswer) {
                result.textContent = "Correct!";
            } else {
                result.textContent = "Incorrect!";
            }

            // Append to PlayerRegistrationData
            let equation = num1 + " x " + num2;
            let response = userAnswer;
            let correctness = result.textContent;
            
            PlayerRegistrationData.push({
                equation: equation,
                response: response,
                correctness: correctness
            });

           
        }
        function displayAllPlayers() {
    // Get the element where players will be displayed
    var displayArea = document.getElementById('showallplayers');

    // Clear any existing content
    displayArea.innerHTML = '';

    // Check if there are any players to display
    if (PlayerRegistrationData && PlayerRegistrationData.length > 0) {
        // Create a list or table element to hold player details
        var list = document.createElement('ul');

        // Iterate over each player and create an item for them
        PlayerRegistrationData.forEach(function(player, index) {
            var listItem = document.createElement('li');
            listItem.textContent = (index + 1) + ". " + player.firstName + " " + player.lastName + " - " + player.email;
            list.appendChild(listItem);
        });

        // Append the list to the display area
        displayArea.appendChild(list);
    } else {
        // Display a message if no players are registered
        displayArea.textContent = 'No players registered yet.';
    }
}

    </script>
    
</html>